A1A2<-ggplot(Mean_Attributes)+aes(x = mean_Vanilla, y=mean_Floral, color=Product)+geom_path(aes(group=1),color="black")+geom_point()
A2A3<-ggplot(Mean_Attributes)+aes(x = mean_Floral, y=mean_Citrus, color=Product)+geom_path(aes(group=1),color="black")+geom_point()
A1A3<-ggplot(Mean_Attributes)+aes(x = mean_Vanilla, y=mean_Citrus, color=Product)+geom_path(aes(group=1), color="black")+geom_point()
grid.arrange(A1A2, A2A3, A1A3, ncol=2, nrow = 2)
cov(Mean_Attributes[,-1])
cov(perfumes[,c("Vanilla","Citrus", "Floral")])
Mean_Attributes<- data.frame(Mean_Attributes, row.names=1)
Attributes_Mat <- cov(Mean_Attributes)
Products_Mat <- as.matrix(dist(Mean_Attributes))
Attributes_Mat
Products_Mat
View(df)
means <- df %>% group_by(Product) %>% summarise(
mean_Spicy=mean(Spicy),
mean_Citrus=mean(Citrus),
mean_Floral=mean(Floral),
mean_Heady=mean(Heady)
)
View(Mean_Attributes)
Mean_Attributes <- perfumes %>% group_by(Product) %>% summarise(
mean_Vanilla=mean(Vanilla),
mean_Citrus=mean(Citrus),
mean_Floral=mean(Floral)
)
Mean_Attributes <- perfumes %>% group_by(Product) %>% summarise(
mean_Vanilla=mean(Vanilla),
mean_Citrus=mean(Citrus),
mean_Floral=mean(Floral)
)
View(Mean_Attributes)
Mean_Attributes<- data.frame(Mean_Attributes, row.names=1)
Attributes_Mat <- cov(Mean_Attributes)
Products_Mat <- as.matrix(dist(Mean_Attributes))
Attributes_Mat
Products_Mat
perfumes$Vanilla <- perfumes$Vanilla/var(perfumes$Vanilla)
perfumes$Floral <- perfumes$Floral/var(perfumes$Floral)
perfumes$Citrus <- perfumes$Citrus/var(perfumes$Citrus)
library("gridExtra")
A1 <- ggplot(perfumes)+aes(y=Floral, x= Product, color=Product)+
stat_summary(fun=mean, geom="line", aes(group=1), color="black") +
stat_summary(fun=mean, geom="point")+
theme(axis.title.x=element_blank(),
axis.text.x=element_blank(),
axis.ticks.x=element_blank())
A2 <- ggplot(perfumes)+aes(y=Vanilla, x= Product, color=Product) +
stat_summary(fun=mean, geom="line", aes(group=1), color="black") +
stat_summary(fun=mean, geom="point")+
theme(axis.title.x=element_blank(),
axis.text.x=element_blank(),
axis.ticks.x=element_blank())
A3 <- ggplot(perfumes)+aes(y=Citrus, x= Product, color=Product) +
stat_summary(fun=mean, geom="line", aes(group=1), color="black") +
stat_summary(fun=mean, geom="point")+
theme(axis.title.x=element_blank(),
axis.text.x=element_blank(),
axis.ticks.x=element_blank())
grid.arrange(A1, A2, A3, ncol=2, nrow = 2)
A1A2<-ggplot(Mean_Attributes)+aes(x = mean_Vanilla, y=mean_Floral, color=Product)+geom_path(aes(group=1),color="black")+geom_point()
A2A3<-ggplot(Mean_Attributes)+aes(x = mean_Floral, y=mean_Citrus, color=Product)+geom_path(aes(group=1),color="black")+geom_point()
A1A3<-ggplot(Mean_Attributes)+aes(x = mean_Vanilla, y=mean_Citrus, color=Product)+geom_path(aes(group=1), color="black")+geom_point()
grid.arrange(A1A2, A2A3, A1A3, ncol=2, nrow = 2)
Mean_Attributes <- perfumes %>% group_by(Product) %>% summarise(
mean_Vanilla=mean(Vanilla),
mean_Citrus=mean(Citrus),
mean_Floral=mean(Floral)
)
A1A2<-ggplot(Mean_Attributes)+aes(x = mean_Vanilla, y=mean_Floral, color=Product)+geom_path(aes(group=1),color="black")+geom_point()
A2A3<-ggplot(Mean_Attributes)+aes(x = mean_Floral, y=mean_Citrus, color=Product)+geom_path(aes(group=1),color="black")+geom_point()
A1A3<-ggplot(Mean_Attributes)+aes(x = mean_Vanilla, y=mean_Citrus, color=Product)+geom_path(aes(group=1), color="black")+geom_point()
grid.arrange(A1A2, A2A3, A1A3, ncol=2, nrow = 2)
df$Floral <- df$Floral/sd(df$Floral)
df$Citrus <- df$Citrus/sd(df$Citrus)
df$Spicy <- df$Spicy/sd(df$Spicy)
df$Heady <- df$Heady/sd(df$Heady)
a1 <- ggplot(df)+aes(y=Floral, x= Product, color=Product)+
stat_summary(fun=mean, geom="line", aes(group=1), color="black") +
stat_summary(fun=mean, geom="point")+
theme(axis.title.x=element_blank(),
axis.text.x=element_blank(),
axis.ticks.x=element_blank())
a2 <- ggplot(df)+aes(y=Citrus, x= Product, color=Product) +
stat_summary(fun=mean, geom="line", aes(group=1), color="black") +
stat_summary(fun=mean, geom="point")+
theme(axis.title.x=element_blank(),
axis.text.x=element_blank(),
axis.ticks.x=element_blank())
a3 <- ggplot(df)+aes(y=Spicy, x= Product, color=Product) +
stat_summary(fun=mean, geom="line", aes(group=1), color="black") +
stat_summary(fun=mean, geom="point")+
theme(axis.title.x=element_blank(),
axis.text.x=element_blank(),
axis.ticks.x=element_blank())
a4 <- ggplot(df)+aes(y=Heady, x= Product, color=Product) +
stat_summary(fun=mean, geom="line", aes(group=1), color="black") +
stat_summary(fun=mean, geom="point")+
theme(axis.title.x=element_blank(),
axis.text.x=element_blank(),
axis.ticks.x=element_blank())
grid.arrange(a1, a2, a3, a4, ncol=2, nrow = 2)
A1A2<-ggplot(Mean_Attributes)+aes(x = mean_Vanilla, y=mean_Floral, color=Product)+geom_path(aes(group=1),color="black")+geom_point()
A2A3<-ggplot(Mean_Attributes)+aes(x = mean_Floral, y=mean_Citrus, color=Product)+geom_path(aes(group=1),color="black")+geom_point()
A1A3<-ggplot(Mean_Attributes)+aes(x = mean_Vanilla, y=mean_Citrus, color=Product)+geom_path(aes(group=1), color="black")+geom_point()
grid.arrange(A1A2, A2A3, A1A3, ncol=2, nrow = 2)
A1A2<-ggplot(Mean_Attributes)+aes(x = mean_Vanilla, y=mean_Floral, color=Product)+geom_path(aes(group=1),color="black")+geom_point()
A2A3<-ggplot(Mean_Attributes)+aes(x = mean_Floral, y=mean_Citrus, color=Product)+geom_path(aes(group=1),color="black")+geom_point()
A1A3<-ggplot(Mean_Attributes)+aes(x = mean_Vanilla, y=mean_Citrus, color=Product)+geom_path(aes(group=1), color="black")+geom_point()
grid.arrange(A1A2, A2A3, A1A3, ncol=2, nrow = 2)
df$Floral <- df$Floral/sd(df$Floral)
df$Citrus <- df$Citrus/sd(df$Citrus)
df$Spicy <- df$Spicy/sd(df$Spicy)
df$Heady <- df$Heady/sd(df$Heady)
a1 <- ggplot(df)+aes(y=Floral, x= Product, color=Product)+
stat_summary(fun=mean, geom="line", aes(group=1), color="black") +
stat_summary(fun=mean, geom="point")+
theme(axis.title.x=element_blank(),
axis.text.x=element_blank(),
axis.ticks.x=element_blank())
a2 <- ggplot(df)+aes(y=Citrus, x= Product, color=Product) +
stat_summary(fun=mean, geom="line", aes(group=1), color="black") +
stat_summary(fun=mean, geom="point")+
theme(axis.title.x=element_blank(),
axis.text.x=element_blank(),
axis.ticks.x=element_blank())
a3 <- ggplot(df)+aes(y=Spicy, x= Product, color=Product) +
stat_summary(fun=mean, geom="line", aes(group=1), color="black") +
stat_summary(fun=mean, geom="point")+
theme(axis.title.x=element_blank(),
axis.text.x=element_blank(),
axis.ticks.x=element_blank())
a4 <- ggplot(df)+aes(y=Heady, x= Product, color=Product) +
stat_summary(fun=mean, geom="line", aes(group=1), color="black") +
stat_summary(fun=mean, geom="point")+
theme(axis.title.x=element_blank(),
axis.text.x=element_blank(),
axis.ticks.x=element_blank())
grid.arrange(a1, a2, a3, a4, ncol=2, nrow = 2)
View(means)
A1A2<-ggplot(Mean_Attributes)+aes(x = mean_Vanilla, y=mean_Floral, color=Product)+geom_path(aes(group=1),color="black")+geom_point()
A2A3<-ggplot(Mean_Attributes)+aes(x = mean_Floral, y=mean_Citrus, color=Product)+geom_path(aes(group=1),color="black")+geom_point()
A1A3<-ggplot(Mean_Attributes)+aes(x = mean_Vanilla, y=mean_Citrus, color=Product)+geom_path(aes(group=1), color="black")+geom_point()
grid.arrange(A1A2, A2A3, A1A3, ncol=2, nrow = 2)
a1 <- ggplot(means)+aes(x = mean_Spicy, y=mean_Citrus, color=Product)+geom_path(aes(group=1),color="black")+geom_point()
a2 <- ggplot(means)+aes(x = mean_Spicy, y=mean_Floral, color=Product)+geom_path(aes(group=1),color="black")+geom_point()
a3 <- ggplot(means)+aes(x = mean_Spicy, y=mean_Heady, color=Product)+geom_path(aes(group=1),color="black")+geom_point()
a4 <- ggplot(means)+aes(x = mean_Citrus, y=mean_Floral, color=Product)+geom_path(aes(group=1),color="black")+geom_point()
a5 <- ggplot(means)+aes(x = mean_Citrus, y=mean_Heady, color=Product)+geom_path(aes(group=1),color="black")+geom_point()
a6 <- ggplot(means)+aes(x = mean_Floral, y=mean_Heady, color=Product)+geom_path(aes(group=1),color="black")+geom_point()
grid.arrange(a1, a2, a3, a4, a5, a6, ncol=2, nrow = 3)
a1 <- ggplot(means)+aes(x = mean_Spicy, y=mean_Citrus, color=Product)+geom_path(aes(group=1),color="black")+geom_point()
a2 <- ggplot(means)+aes(x = mean_Spicy, y=mean_Floral, color=Product)+geom_path(aes(group=1),color="black")+geom_point()
a3 <- ggplot(means)+aes(x = mean_Spicy, y=mean_Heady, color=Product)+geom_path(aes(group=1),color="black")+geom_point()
a4 <- ggplot(means)+aes(x = mean_Citrus, y=mean_Floral, color=Product)+geom_path(aes(group=1),color="black")+geom_point()
a5 <- ggplot(means)+aes(x = mean_Citrus, y=mean_Heady, color=Product)+geom_path(aes(group=1),color="black")+geom_point()
a6 <- ggplot(means)+aes(x = mean_Floral, y=mean_Heady, color=Product)+geom_path(aes(group=1),color="black")+geom_point()
grid.arrange(a1, a2, a3, a4, a5, a6, ncol=3, nrow = 2)
a1 <- ggplot(means)+aes(x = mean_Spicy, y=mean_Citrus, color=Product)+geom_path(aes(group=1),color="black")+geom_point()
a2 <- ggplot(means)+aes(x = mean_Spicy, y=mean_Floral, color=Product)+geom_path(aes(group=1),color="black")+geom_point()
a3 <- ggplot(means)+aes(x = mean_Spicy, y=mean_Heady, color=Product)+geom_path(aes(group=1),color="black")+geom_point()
a4 <- ggplot(means)+aes(x = mean_Citrus, y=mean_Floral, color=Product)+geom_path(aes(group=1),color="black")+geom_point()
a5 <- ggplot(means)+aes(x = mean_Citrus, y=mean_Heady, color=Product)+geom_path(aes(group=1),color="black")+geom_point()
a6 <- ggplot(means)+aes(x = mean_Floral, y=mean_Heady, color=Product)+geom_path(aes(group=1),color="black")+geom_point()
grid.arrange(a1, a2, a3, a4, a5, a6, ncol=3, nrow = 2)
ggplot(means)+aes(x = mean_Spicy, y=mean_Citrus, color=Product)+geom_path(aes(group=1),color="black")+geom_point()
ggplot(means)+aes(x = mean_Spicy, y=mean_Floral, color=Product)+geom_path(aes(group=1),color="black")+geom_point()
ggplot(means)+aes(x = mean_Spicy, y=mean_Citrus, color=Product)+geom_path(aes(group=1),color="black")+geom_point()
a1 <- ggplot(means)+aes(x = mean_Spicy, y=mean_Citrus, color=Product)+geom_path(aes(group=1),color="black")+geom_point()
a2 <- ggplot(means)+aes(x = mean_Spicy, y=mean_Floral, color=Product)+geom_path(aes(group=1),color="black")+geom_point()
a3 <- ggplot(means)+aes(x = mean_Spicy, y=mean_Heady, color=Product)+geom_path(aes(group=1),color="black")+geom_point()
a4 <- ggplot(means)+aes(x = mean_Citrus, y=mean_Floral, color=Product)+geom_path(aes(group=1),color="black")+geom_point()
a5 <- ggplot(means)+aes(x = mean_Citrus, y=mean_Heady, color=Product)+geom_path(aes(group=1),color="black")+geom_point()
a6 <- ggplot(means)+aes(x = mean_Floral, y=mean_Heady, color=Product)+geom_path(aes(group=1),color="black")+geom_point()
grid.arrange(a1, a2, a3, a4, a5, a6, ncol=3, nrow = 2)
ggplot(means)+aes(x = mean_Floral, y=mean_Heady, color=Product)+geom_path(aes(group=1),color="black")+geom_point()
a1 <- ggplot(means)+aes(x = mean_Spicy, y=mean_Citrus, color=Product)+geom_path(aes(group=1),color="black")+geom_point()
a2 <- ggplot(means)+aes(x = mean_Spicy, y=mean_Floral, color=Product)+geom_path(aes(group=1),color="black")+geom_point()
a3 <- ggplot(means)+aes(x = mean_Spicy, y=mean_Heady, color=Product)+geom_path(aes(group=1),color="black")+geom_point()
a4 <- ggplot(means)+aes(x = mean_Citrus, y=mean_Floral, color=Product)+geom_path(aes(group=1),color="black")+geom_point()
a5 <- ggplot(means)+aes(x = mean_Citrus, y=mean_Heady, color=Product)+geom_path(aes(group=1),color="black")+geom_point()
a6 <- ggplot(means)+aes(x = mean_Floral, y=mean_Heady, color=Product)+geom_path(aes(group=1),color="black")+geom_point()
grid.arrange(a1, a2, a3, a4, a5, a6, ncol=2, nrow = 3)
ggplot(means)+aes(x = mean_Floral, y=mean_Heady, color=Product)+geom_path(aes(group=1),color="black")+geom_point()
a6
View(a6)
a1 <- ggplot(means)+aes(x = mean_Spicy, y=mean_Citrus, color=Product)+geom_path(aes(group=1),color="black")+geom_point()
a2 <- ggplot(means)+aes(x = mean_Spicy, y=mean_Floral, color=Product)+geom_path(aes(group=1),color="black")+geom_point()
a3 <- ggplot(means)+aes(x = mean_Spicy, y=mean_Heady, color=Product)+geom_path(aes(group=1),color="black")+geom_point()
a4 <- ggplot(means)+aes(x = mean_Citrus, y=mean_Floral, color=Product)+geom_path(aes(group=1),color="black")+geom_point()
a5 <- ggplot(means)+aes(x = mean_Citrus, y=mean_Heady, color=Product)+geom_path(aes(group=1),color="black")+geom_point()
a6 <- ggplot(means)+aes(x = mean_Floral, y=mean_Heady, color=Product)+geom_path(aes(group=1),color="black")+geom_point()
grid.arrange(a1, a2, a3, a4, a5, a6, ncol=2, nrow = 3)
grid.arrange(a1, a2, a3, a4, a5, a6, ncol=2, nrow = 3)
a1 <- ggplot(means)+aes(x = mean_Spicy, y=mean_Citrus, color=Product)+geom_path(aes(group=1),color="black")+geom_point()
a2 <- ggplot(means)+aes(x = mean_Spicy, y=mean_Floral, color=Product)+geom_path(aes(group=1),color="black")+geom_point()
a3 <- ggplot(means)+aes(x = mean_Spicy, y=mean_Heady, color=Product)+geom_path(aes(group=1),color="black")+geom_point()
a4 <- ggplot(means)+aes(x = mean_Citrus, y=mean_Floral, color=Product)+geom_path(aes(group=1),color="black")+geom_point()
a5 <- ggplot(means)+aes(x = mean_Citrus, y=mean_Heady, color=Product)+geom_path(aes(group=1),color="black")+geom_point()
a6 <- ggplot(means)+aes(x = mean_Floral, y=mean_Heady, color=Product)+geom_path(aes(group=1),color="black")+geom_point()
grid.arrange(a1, a2, a3, a4, a5, a6, ncol=2, nrow = 3)
a1 <- ggplot(means)+aes(x = mean_Spicy, y=mean_Citrus, color=Product)+geom_path(aes(group=1),color="black")+geom_point()
a2 <- ggplot(means)+aes(x = mean_Spicy, y=mean_Floral, color=Product)+geom_path(aes(group=1),color="black")+geom_point()
a3 <- ggplot(means)+aes(x = mean_Spicy, y=mean_Heady, color=Product)+geom_path(aes(group=1),color="black")+geom_point()
a4 <- ggplot(means)+aes(x = mean_Citrus, y=mean_Floral, color=Product)+geom_path(aes(group=1),color="black")+geom_point()
a5 <- ggplot(means)+aes(x = mean_Citrus, y=mean_Heady, color=Product)+geom_path(aes(group=1),color="black")+geom_point()
a6 <- ggplot(means)+aes(x = mean_Floral, y=mean_Heady, color=Product)+geom_path(aes(group=1),color="black")+geom_point()
grid.arrange(a1, a2, a3, a4, a5, a6, ncol=2, nrow = 3)
par(mfrow=c(1,3))
boxplot(perfumes$Floral, main="Floral")
text(0.75,mean(perfumes$Floral)+0.25, "mean", pos=2)
abline(h=mean(perfumes$Floral))
text(0.75,min(perfumes$Vanilla)+0.25, "min", pos=2)
abline(h=min(perfumes$Vanilla))
text(0.75,quantile(perfumes$Floral, probs = 0.25)+0.25, "q1", pos=2)
abline(h=quantile(perfumes$Floral, probs = 0.25))
text(0.75,quantile(perfumes$Floral, probs = 0.75)+0.25, "q3", pos=2)
abline(h=quantile(perfumes$Floral, probs = 0.75))
text(0.75,quantile(perfumes$Floral, probs = 0.5)+0.25, "Median", pos=2)
abline(h=quantile(perfumes$Floral, probs = 0.5))
text(0.75,quantile(perfumes$Floral, probs = 1)+0.25, "max", pos=2)
abline(h=quantile(perfumes$Floral, probs = 1))
boxplot(perfumes$Vanilla, main="Vanilla")
text(0.75,mean(perfumes$Vanilla)+0.25, "mean", pos=2)
abline(h=mean(perfumes$Vanilla))
boxplot(perfumes$Citrus, main="Citrus")
abline(h=mean(perfumes$Citrus))
text(0.75,mean(perfumes$Citrus)+0.25, "mean", pos=2)
A1A2<-ggplot(Mean_Attributes)+aes(x = mean_Vanilla, y=mean_Floral, color=Product)+geom_path(aes(group=1),color="black")+geom_point()
A2A3<-ggplot(Mean_Attributes)+aes(x = mean_Floral, y=mean_Citrus, color=Product)+geom_path(aes(group=1),color="black")+geom_point()
A1A3<-ggplot(Mean_Attributes)+aes(x = mean_Vanilla, y=mean_Citrus, color=Product)+geom_path(aes(group=1), color="black")+geom_point()
grid.arrange(A1A2, A2A3, A1A3, ncol=2, nrow = 2)
cov(Mean_Attributes[,-1])
cov(perfumes[,c("Vanilla","Citrus", "Floral")])
Mean_Attributes <- data.frame(Mean_Attributes, row.names=1)
Attributes_Mat <- cov(Mean_Attributes)
Products_Mat <- as.matrix(dist(Mean_Attributes))
Attributes_Mat
Products_Mat
heatmap(Attributes_Mat,Colv = NA, Rowv = NA)
heatmap(Products_Mat,Colv = NA, Rowv = NA)
Products_sc_Mat <- as.matrix(dist(scale(Mean_Attributes))^2)
Products_sc_Mat
sum(Products_sc_Mat)/12
a1 <- ggplot(means)+aes(x = mean_Spicy, y=mean_Citrus, color=Product)+geom_path(aes(group=1),color="black")+geom_point()
a2 <- ggplot(means)+aes(x = mean_Spicy, y=mean_Floral, color=Product)+geom_path(aes(group=1),color="black")+geom_point()
a3 <- ggplot(means)+aes(x = mean_Spicy, y=mean_Heady, color=Product)+geom_path(aes(group=1),color="black")+geom_point()
a4 <- ggplot(means)+aes(x = mean_Citrus, y=mean_Floral, color=Product)+geom_path(aes(group=1),color="black")+geom_point()
a5 <- ggplot(means)+aes(x = mean_Citrus, y=mean_Heady, color=Product)+geom_path(aes(group=1),color="black")+geom_point()
a6 <- ggplot(means)+aes(x = mean_Floral, y=mean_Heady, color=Product)+geom_path(aes(group=1),color="black")+geom_point()
grid.arrange(a1, a2, a3, a4, a5, a6, ncol=2, nrow = 3)
a1 <- ggplot(means)+aes(x = mean_Spicy, y=mean_Citrus, color=Product)+geom_path(aes(group=1),color="black")+geom_point()
a2 <- ggplot(means)+aes(x = mean_Spicy, y=mean_Floral, color=Product)+geom_path(aes(group=1),color="black")+geom_point()
a3 <- ggplot(means)+aes(x = mean_Spicy, y=mean_Heady, color=Product)+geom_path(aes(group=1),color="black")+geom_point()
a4 <- ggplot(means)+aes(x = mean_Citrus, y=mean_Floral, color=Product)+geom_path(aes(group=1),color="black")+geom_point()
a5 <- ggplot(means)+aes(x = mean_Citrus, y=mean_Heady, color=Product)+geom_path(aes(group=1),color="black")+geom_point()
a6 <- ggplot(means)+aes(x = mean_Floral, y=mean_Heady, color=Product)+geom_path(aes(group=1),color="black")+geom_point()
grid.arrange(a1, a2, a3, a4, a5, a6, ncol=2, nrow = 3)
cov(means)
means
means <- data.frame(means, row.names = 1)
cov(means)
cov.matrix <- cov(means)
dist(cov.matrix)
means.variables <- data.frame(means, row.names = 1)
means <- df %>% group_by(Product) %>% summarise(
mean_Spicy=mean(Spicy),
mean_Citrus=mean(Citrus),
mean_Floral=mean(Floral),
mean_Heady=mean(Heady)
)
?heatmap
Products_Mat
heatmap(Products_Mat,Colv = NULL, Rowv = NULL)
heatmap(Products_Mat,Colv = NULL, Rowv = NULL)
heatmap(Attributes_Mat,Colv = NA, Rowv = NA)
heatmap(Products_Mat,Colv = NA, Rowv = NA)
att.dist <- dist(cov.matrix)
att.dist
cov.matrix
att.dist <- as.matrix(dist(cov.matrix))
cov.matrix
att.dist
cov.att <- cov(means.variables)
dist.products <- as.matrix(dist(cov.matrix))
dist.products
cov.products <- cov(means.variables)
dist.att <- as.matrix(dist(cov.matrix))
cov.products
cov.att <- cov(means.variables)
dist.prod <- as.matrix(dist(cov.matrix))
dist.prod
dist.prod <- as.matrix(dist(cov.att))
dist.prod
Mean_Attributes
Attributes_Mat <- cov(Mean_Attributes)
Products_Mat <- as.matrix(dist(Mean_Attributes))
Attributes_Mat
Products_Mat
cov.att
dist.prod <- as.matrix(dist(means.variables))
dist.prod
means.variables
means.variables <- data.frame(means, row.names = 1)
means
means.variables
dist.prod <- as.matrix(dist(means.variables))
dist(means.variables)
dist(means.variables)
dist(means.variables)
dist(means.variables)
means.variables
means <- df %>% group_by(Product) %>% summarise(
mean_Spicy=mean(Spicy),
mean_Citrus=mean(Citrus),
mean_Floral=mean(Floral)
)
spicy.matrix <- as.matrix(dist(means$mean_Spicy))
citrus.matrix <- as.matrix(dist(means$mean_Citrus))
floral.matrix <- as.matrix(dist(means$mean_Floral))
means
a1 <- ggplot(means)+aes(x = mean_Spicy, y=mean_Citrus, color=Product)+geom_path(aes(group=1),color="black")+geom_point()
a2 <- ggplot(means)+aes(x = mean_Spicy, y=mean_Floral, color=Product)+geom_path(aes(group=1),color="black")+geom_point()
a3 <- ggplot(means)+aes(x = mean_Citrus, y=mean_Floral, color=Product)+geom_path(aes(group=1),color="black")+geom_point()
grid.arrange(a1, a2, a3, ncol=3, nrow = 1)
grid.arrange(a1, a2, a3, ncol=2, nrow = 2)
means.variables <- data.frame(means, row.names = 1)
cov.att <- cov(means.variables)
dist.prod <- as.matrix(dist(means.variables))
dist.prod
cov.att
sorted(cov.att)
heatmap(cov.att)
heatmap(dist.prod)
Mean_Attributes
Products_sc_Mat <- as.matrix(dist(scale(dist.prod))^2)
sum(Products_sc_Mat)/12
dim(Products_sc_Mat)
dim(Products_sc_Mat)[1]
sum(Products_sc_Mat)/2*dim(Products_sc_Mat)[1]/(dim(Products_sc_Mat)[1]-1)
sum(Products_sc_Mat)/(2*dim(Products_sc_Mat)[1]/(dim(Products_sc_Mat)[1]-1))
(2*dim(Products_sc_Mat)[1]/(dim(Products_sc_Mat)[1]-1))
sum(Products_sc_Mat)/(2*dim(Products_sc_Mat)[1]*(dim(Products_sc_Mat)[1]-1))
heatmap(cov.att)
cov.att
heatmap(cov.att)
heatmap(dist.prod)
cov.att
heatmap(cov.att)
heatmap(dist.prod)
dist.prod
cov.att
sum(diag( cov.att))
cov.att(1:2,1:2)
cov.att[1:2,1:2]
e <- eigen(cov.att) #solving for the eigenvalues and eigenvectors from the correlation matrix
str(e)
L <- e$values #placing the eigenvalues in L
Vm <- matrix(0, nrow = p, ncol = p) #creating a p x p matrix with zeroes.
p <- ncol(cov.att) #no of variables, I know it's not good to name your variables
Vm <- matrix(0, nrow = p, ncol = p) #creating a p x p matrix with zeroes.
#Vm is an orthogonal matrix since all correlations between variable are 0.
diag(Vm) <- L #putting the eigenvalues in the diagonals
Vm #c
e$vectors
loadings <- e$vectors %*% sqrt(Vm)
e$vectors %*% Vm %*% t(e$vectors)
L/length(L)
zdat <- scale(dat) #this is just to standardize the original data, M = 0, SD =1
zdat <- scale(cov.att) #this is just to standardize the original data, M = 0, SD =1
pca.scores <- zdat %*% e$vectors #scaled values x vectors
#this is just P = XA in the notes
colnames(pca.scores) <- paste0('pca', 1:6)
pca.scores
#this is just P = XA in the notes
colnames(pca.scores) <- paste0('pca', 1:3)
head(pca.scores)
apply(pca.scores, 2, var)
e$values
PCA(cov.att)
library(FactoMineR)
PCA(cov.att)
res.pca <- PCA(cov.att)
res.pca$eig
e$values
pca.scores
res.pca$var
X <- cov.att
m <- apply(X,2,mean) #mean
print(m,digits=3)
s <- apply(X,2,sd) #standard deviation
print(s,digits=3)
Y <- sweep(X,2,m,"-")
apply(Y,2,mean)
apply(Y,2,sd)
Z <- sweep(Y,2,s,"/")
apply(Z,2,sd)
# PCA
R <- t(as.matrix(Z))%*%as.matrix(Z)/7
e <- eigen(R)
names(e)
dim(e$vectors)
#matrix with the q=3 first eigenvectors
q <- 3
V <- e$vectors[,1:q]
Fbis <- as.matrix(Z)%*%V
head(Fbis)
head(F[,1:q]) #with the PCA function
head(F[,1:3]) #with the PCA function
head(F[,1:2]) #with the PCA function
R <- t(as.matrix(Z))%*%as.matrix(Z)/7
e <- eigen(R)
names(e)
dim(e$vectors)
#matrix with the q=3 first eigenvectors
q <- 3
V <- e$vectors[,1:q]
Fbis <- as.matrix(Z)%*%V
head(Fbis)
PCA(cov.att)
head(Fbis)
res.pca$var
res.pca$eig
e
res.pca <- PCA(scale(cov.att), scale.unit = F)
res.pca$eig
e
s <- apply(Y,2,sd)*sqrt((n-1)/n)
# SVD
n <- nrow(X)
#first compute Z with the non corrected standard deviation
s <- apply(Y,2,sd)*sqrt((n-1)/n)
Z <- sweep(Y,2,s,"/")
e_svd <- svd(Z)
names(e_svd)
(e_svd$d^2)[1:q]/n #division by n because of the metric
res$eig[1:q,1] #output of the PCA function
res.pca$eig[1:q,1] #output of the PCA function
res.pca$eig #output of the PCA function
(e_svd$d^2)[1:q]/n #division by n because of the metric
res.pca$eig
res.pca <- PCA(cov.att, graph = F)
res.pca$eig #output of the PCA function
X <- means.variables
X <- means.variables
m <- apply(X,2,mean) #mean
print(m,digits=3)
s <- apply(X,2,sd) #standard deviation
print(s,digits=3)
Y <- sweep(X,2,m,"-")
apply(Y,2,mean)
apply(Y,2,sd)
Z <- sweep(Y,2,s,"/")
apply(Z,2,sd)
Z
R <- t(as.matrix(Z))%*%as.matrix(Z)/7
e <- eigen(R)
names(e)
dim(e$vectors)
#matrix with the q=3 first eigenvectors
q <- 3
V <- e$vectors[,1:q]
Fbis <- as.matrix(Z)%*%V
head(Fbis)
n <- nrow(X)
#first compute Z with the non corrected standard deviation
s <- apply(Y,2,sd)*sqrt((n-1)/n)
Z <- sweep(Y,2,s,"/")
e_svd <- svd(Z)
names(e_svd)
(e_svd$d^2)[1:q]/n #division by n because of the metric
#output of the PCA function
U <- e_svd$u[,1:q] #matrix of the q first left singular vectors
Fbisbis <- U%*%diag(e_svd$d[1:q]) #principal components
head(Fbisbis)
head(Fbisbis)
head(Fbis)
res.pca <- PCA(X, graph = F)
res.pca$var
m
s
# Calcul vectoriel
R <- t(as.matrix(Z))%*%as.matrix(Z)/3
e <- eigen(R)
names(e)
dim(e$vectors)
q <- 3
V <- e$vectors[,1:q]
Fbis <- as.matrix(Z)%*%V
head(Fbis)
head(Fbis)
head(F[,1:q])
F <- res$ind$coord
F <- res.pca$ind$coord
head(Fbis)
head(F[,1:q])
F
head(Fbis)
head(F)
n <- nrow(X)
#first compute Z with the non corrected standard deviation
s <- apply(Y,2,sd)*sqrt((n-1)/n)
Z <- sweep(Y,2,s,"/")
e_svd <- svd(Z)
names(e_svd)
(e_svd$d^2)[1:q]/n #division by n because of the metric
U <- e_svd$u[,1:q] #matrix of the q first left singular vectors
Fbisbis <- U%*%diag(e_svd$d[1:q]) #principal components
head(Fbisbis)
head(F)
head(Fbis)
head(F)
head(Fbisbis)
head(F)
