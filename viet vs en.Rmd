---
title: "Vietnamien VS English"
output: pdf_document
---
```{r}
library(readxl)
library(dplyr)
library(FactoMineR)
library(vietnameseConverter)
library(stringi)
```

# Import + modifications 

Import du jeu de données initial (sans traduction):
```{r}
barbes <- read_excel("data/barbes.xlsx")
```

Import de la traduction :

On importe avec les accents et on créait une nouvelle colonne sans eux avec la fonction `stri_trans_general()` du package `stringi` (il permet de faire de la translitération de texte) 
```{r}
trad <- read.table("data/traduction.txt", sep="\n", header = TRUE, encoding = "UTF-8") 
colnames(trad) <- "trad_avec_accents"
trad <- trad %>% mutate(trad_sans_accents = stri_trans_general(trad_avec_accents, "Latin-ASCII")) 
```

Mutate + transformation en variables catégorielles :
```{r}
barbes <- cbind(barbes, trad)

barbes$Barbes <- as.factor(barbes$Barbes)
barbes$Juge <- as.factor(barbes$Juge)
```

Vérification :
```{r}
summary(barbes)

summary(barbes$Barbes)

# Un B7 au lieu de b7 traîne, correction :
levels(barbes$Barbes) <- c("b1","b2", "b3", "b4","b5","b6","b7","b7","b8")
summary(barbes$Barbes)
```
Création de deux df : viet et en
```{r}
barbes.en <- barbes[,-4]
barbes.en <- barbes.en[,-4]

barbes.viet <- barbes[,-3]
```

## Tableaux de contingence

Deux options : 
- en délimitant les effectifs à >10, 
- aucune délimitation.

Pour les mots anglais : 
```{r}
res.textual.en <- textual(barbes.en,num.text = 3, contingence.by = 1, sep.word = ";")

eff.en <- as.data.frame(apply(res.textual.en$cont.table, MARGIN = 2, FUN=sum))

# Tout les mots : 627 mots
words_selection.en <- res.textual.en$cont.table[,apply(res.textual.en$cont.table, 2, sum)]
# Sélection des mots qui apparaissent plus de 10 fois : 31
words_selection_sup10.en <- res.textual.en$cont.table[,apply(res.textual.en$cont.table, 2, sum)>=10]
```

Viet sans accent :
```{r}
res.textual.viet.sans.accent <- textual(barbes.viet[,-3],num.text = 3, contingence.by = 1, sep.word = ";")

eff.viet <- as.data.frame(apply(res.textual.viet.sans.accent$cont.table, MARGIN = 2, FUN=sum))

# Tout les mots : 669 mots
words_selection.viet.sans.accent <- res.textual.viet.sans.accent$cont.table[,apply(res.textual.viet.sans.accent$cont.table, 2, sum)]
# Sélection des mots qui apparaissent plus de 10 fois : 29
words_selection_sup10.viet.sans.accent <- res.textual.viet.sans.accent$cont.table[,apply(res.textual.viet.sans.accent$cont.table, 2, sum)>=10]
```

Viet avec accents :
```{r}
res.textual.viet <- textual(barbes.viet[,-4],num.text = 3, contingence.by = 1, sep.word = ";")

eff.viet <- as.data.frame(apply(res.textual.viet$cont.table, MARGIN = 2, FUN=sum))

# Tout les mots : 669 mots
words_selection.viet <- res.textual.viet$cont.table[,apply(res.textual.viet$cont.table, 2, sum)]
# Sélection des mots qui apparaissent plus de 10 fois : 29
words_selection_sup10.viet <- res.textual.viet$cont.table[,apply(res.textual.viet$cont.table, 2, sum)>=10]
```

En résumé : 
- en anglais; sur 627 mots, 31 apparaissent plus de 10 fois;
- en vietnamien; sur 669 mots, 29 apparaissent plus de 10 fois. 

-> problème de traduction (problème pas très important ici)

# Analyse exploratoire 

## CA
Deux CA :
- sur tout les mots,
- sur les mots qui aparaissent plus de 10 fois.

Anglais : 
```{r}
res.CA.en <- CA(words_selection.en, graph=FALSE)
#plot.CA(res.CA.en) -> illisible

res.CA.sup10.en <- CA(words_selection_sup10.en, graph=FALSE)
plot.CA(res.CA.sup10.en)
```
Vietnamien sans accent : 
```{r}
res.CA.viet <- CA(words_selection.viet.sans.accent, graph=FALSE)
# plot.CA(res.CA.viet) -> illisible

res.CA.sup10.viet.sans.accent <- CA(words_selection_sup10.viet.sans.accent, graph=FALSE)
plot.CA(res.CA.sup10.viet.sans.accent, invisible="row")
```

Vietnamien avec accent : 
```{r}
res.CA.viet <- CA(words_selection.viet, graph=FALSE)
# plot.CA(res.CA.viet) -> illisible

res.CA.sup10.viet <- CA(words_selection_sup10.viet, graph=FALSE)
plot.CA(res.CA.sup10.viet, invisible="row")

res.CA.sup10.viet$col$coord
res.CA.sup10.viet.sans.accent$col$coord
```
# Comparaison

```{r}
res.CA.sup10.en$col$coord
res.CA.sup10.viet$col$coord
res.CA.sup10.viet.sans.accent$col$coord
```

Conclusion : 
- avec ou sans accents, les coord pour les mots viet sont les mêmes
- différence avec anglais mais pcq trad bancale

# Plus petits jeu de données avec vérification de traduction 

```{r}
barbesV2 <- barbes[1:12,]
barbesV2 <- barbesV2[-2,]
barbesV2 <- barbesV2[-7,]
```

